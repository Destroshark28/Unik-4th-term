.model tiny

.code

org 80h            ; ???????? 80h ?? ?????? PSP

cmd_length db ?            ; ????? ????????? ??????

cmd_line   db ?            ; ???? ????????? ??????

org 100h           ; ?????? ????????? 100h ?? ?????? PSP

start:

cld                ; ??? ?????? ????????? ?????????

mov bp,sp          ; ????????? ??????? ??????? ????? ? ??



mov cl,cmd_length

cmp cl,1           ; ???????? ????? ????????? ??????

jle exit           ; ????? ?? ?????????



; ????????????? ?????? ?????????? ? PSP ???, ?????

; ?????? ???????? ???????????? ????? (ASCIZ-??????)

; ?????? ???? ?????????? ????????? ? ????

; ? ?????????? argc ???????? ????? ??????????



mov cx,-1          ; ??? ?????? ?????? ?? ????????

mov di,offset cmd_line ; ?????? ????????? ?????? ? ES:DI



find_param:

mov al,' '         ; AL = ??????

repz scasb         ; ?????? ?? ??????

dec di             ; DI = ????? ?????? ?????????

push di            ; ????????? ????? ? ????

inc word ptr argc  ; ????????? argc ?? 1

mov si,di          ; SI = DI ??? ????????? ??????? lodsb



scan_params:

lodsb              ; ????????? ?????? ?? ?????????

cmp al,0Dh         ; ???? 0Dh - ????????? ????????

je params_ended    ; ????????? ???????????

cmp al,20h           ; ????????? ? ????????

jne scan_params      ; ??????? ???????? ?? ??????????



dec si               ; SI = ?????? ???? ????? ?????????

mov byte ptr [si],0  ; ???????? ? ???? 0

mov di,si            ; DI = SI ??? ??????? scasb

inc di               ; DI = ????????? ????? ???? ??????

jmp short find_param ; ?????????? ?????? ????????? ??????



params_ended:

dec si               ; SI = ?????? ???? ????? ?????

;      ?????????? ?????????

mov byte ptr [si],0  ; ???????? ? ???? 0



; ?????? ? ???????????

...



exit:

ret                  ; ????? ?????????



; ?????? ?????????

argc dw 0 ; ????? ??????????



end start



; [SOURCE]: C:\users\ilyshka\Desktop\Unik\Kpiyap\third_lab.asm
